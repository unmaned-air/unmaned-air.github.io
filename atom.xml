<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://unmaned-air.github.io</id>
    <title>Gridea</title>
    <updated>2022-05-27T15:58:45.846Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://unmaned-air.github.io"/>
    <link rel="self" href="https://unmaned-air.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://unmaned-air.github.io/images/avatar.png</logo>
    <icon>https://unmaned-air.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[æœŸæœ«å‰å¤•çš„C++]]></title>
        <id>https://unmaned-air.github.io/post/qi-mo-qian-xi-de-c/</id>
        <link href="https://unmaned-air.github.io/post/qi-mo-qian-xi-de-c/">
        </link>
        <updated>2022-05-27T03:17:39.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>ä»¥ä¸‹æ˜¯æˆ‘åœ¨å¤ä¹ çš„è¿‡ç¨‹ä¸­å‘ç°çš„åç‚¹</p>
</blockquote>
<h3 id="ä¸€äº›å®¹æ˜“è¢«æåˆ°çš„çŸ¥è¯†ç‚¹">ä¸€äº›å®¹æ˜“è¢«æåˆ°çš„çŸ¥è¯†ç‚¹</h3>
<ul>
<li>ç¼–å†™C++ç¨‹åºä¸€èˆ¬éœ€è¦ç»è¿‡çš„å‡ ä¸ªæ­¥éª¤ä¾æ¬¡æ˜¯ï¼š<em>ç¼–è¾‘ã€ç¼–è¯‘ã€è¿æ¥ã€è¿è¡Œ</em></li>
<li><a href="https://unmaned-air.github.io/post/fu-zhi-jian-rong-xing-gui-ze/">èµ‹å€¼å…¼å®¹æ€§è§„åˆ™</a>æ˜¯æŒ‡æ´¾ç”Ÿç±»å¯¹è±¡å¯ä»¥å½“ä½œåŸºç±»å¯¹è±¡ä½¿ç”¨ï¼Œåªè¦å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œæ‰€ä»¥å•ç»§æ‰¿æˆ–å¤šç»§æ‰¿éƒ½é€‚ç”¨ã€‚</li>
<li></li>
</ul>
<h3 id="ç©ºæŒ‡é’ˆå’Œé‡æŒ‡é’ˆ">ç©ºæŒ‡é’ˆå’Œé‡æŒ‡é’ˆ</h3>
<p><strong>ç©ºæŒ‡é’ˆï¼š</strong> æŒ‡é’ˆå˜é‡æŒ‡å‘å†…å­˜ä¸­ç¼–å·ä¸º0çš„ç©ºé—´ï¼Œå¯ä»¥åˆå§‹åŒ–æŒ‡é’ˆå˜é‡ï¼ˆ<em>å› ä¸ºé‡æŒ‡é’ˆé‡ä¸€ç‚¹</em>ï¼‰ï¼Œä½†ç©ºæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜æ˜¯ä¸å¯ä»¥è®¿é—®çš„ã€‚<br>
<strong>é‡æŒ‡é’ˆï¼š</strong> æŒ‡é’ˆå˜é‡æŒ‡å‘éæ³•çš„ç©ºé—´ï¼ˆ<em>æ¯”å¦‚æŒ‡å‘åœ°å€ç¼–å·ä¸ºæŸæŸçš„ç©ºé—´ï¼Œæ¯”å¦‚æŒ‡é’ˆæŒ‡å‘æ•°ç»„æº¢å‡ºçš„ä½ç½®</em>ï¼‰</p>
<h3 id="constä¿®é¥°æŒ‡é’ˆ">constä¿®é¥°æŒ‡é’ˆ</h3>
<ul>
<li>å¸¸é‡çš„æŒ‡é’ˆï¼ˆ<em>const int</em>  *pï¼‰<br>
æŒ‡é’ˆæŒ‡å‘å¯ä»¥ä¿®æ”¹ï¼Œä½†æŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸å¯ä¿®æ”¹<br>
<em>ç†è§£ä¸ºconst int åé¢å¸¦äº†ä¸ª  * æŒ‡é’ˆ</em></li>
<li>æŒ‡é’ˆçš„å¸¸é‡ï¼ˆ<em>int * const</em>ï¼‰<br>
æŒ‡é’ˆæŒ‡å‘ä¸å¯ä¿®æ”¹ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å€¼å¯ä»¥ä¿®æ”¹<br>
<em>ç†è§£ä¸º * åé¢å¸¦ç€const ï¼Œconstå…³é”®å­—ä¿®é¥°çš„æ˜¯æŒ‡é’ˆå˜é‡</em></li>
<li>åŒæ—¶ä¿®é¥°<br>
æŒ‡é’ˆæŒ‡å‘ä¸æŒ‡é’ˆæŒ‡å‘çš„å€¼éƒ½ä¸å¯ä»¥ä¿®æ”¹ã€‚</li>
</ul>
<pre><code class="language-C++">int main() {

	int a = 10;
	int b = 10;

	//constä¿®é¥°çš„æ˜¯æŒ‡é’ˆï¼ŒæŒ‡é’ˆæŒ‡å‘å¯ä»¥æ”¹ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸å¯ä»¥æ›´æ”¹
	const int * p1 = &amp;a; 
	p1 = &amp;b; //æ­£ç¡®
	//*p1 = 100;  æŠ¥é”™
	

	//constä¿®é¥°çš„æ˜¯å¸¸é‡ï¼ŒæŒ‡é’ˆæŒ‡å‘ä¸å¯ä»¥æ”¹ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å€¼å¯ä»¥æ›´æ”¹
	int * const p2 = &amp;a;
	//p2 = &amp;b; //é”™è¯¯
	*p2 = 100; //æ­£ç¡®

    //constæ—¢ä¿®é¥°æŒ‡é’ˆåˆä¿®é¥°å¸¸é‡
	const int * const p3 = &amp;a;
	//p3 = &amp;b; //é”™è¯¯
	//*p3 = 100; //é”™è¯¯

	system(&quot;pause&quot;);

	return 0;
}
</code></pre>
<h3 id="å†…å­˜åˆ†åŒºæ¨¡å‹">å†…å­˜åˆ†åŒºæ¨¡å‹</h3>
<ol>
<li>ä»£ç åŒºï¼šå°±æ˜¯ä»£ç æ‰€å çš„å†…å­˜ï¼›</li>
<li>å…¨å±€åŒºï¼šå­˜æ”¾å…¨å±€å˜é‡å’Œé™æ€å˜é‡ï¼›</li>
<li>æ ˆåŒºï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ï¼Œå­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ã€å±€éƒ¨å˜é‡ç­‰ï¼›</li>
<li>å †åŒºï¼šç”±ç¨‹åºå‘˜åˆ†é…å’Œé‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶ç”±æ“ä½œç³»ç»Ÿå›æ”¶ã€‚ï¼ˆ<em>new</em>ï¼‰</li>
</ol>
<blockquote>
<p>ä¸åŒåŒºåŸŸå­˜æ”¾çš„æ•°æ®èµ‹äºˆä¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œç»™æˆ‘ä»¬æ›´å¤§çš„çµæ´»ç¼–ç¨‹</p>
</blockquote>
<h3 id="newæ“ä½œç¬¦">newæ“ä½œç¬¦</h3>
<p>C++ä¸­åˆ©ç”¨newæ“ä½œç¬¦åœ¨å †åŒºå¼€è¾Ÿå†…å­˜ï¼Œåœ¨ç¨‹åºçš„æœ€åè¦è®°å¾— <em>delete</em> æ•°æ®ã€‚<br>
åˆ©ç”¨newåˆ›å»ºçš„æ•°æ®ï¼Œä¼šè¿”å›è¯¥æ•°æ®å¯¹åº”ç±»å‹çš„æŒ‡é’ˆã€‚<br>
éœ€è¦æ³¨æ„çš„æ˜¯å¼€è¾Ÿæ•°ç»„çš„æ—¶å€™çš„æ“ä½œæ˜¯å±‚å±‚è¦†ç›–çš„ã€‚</p>
<ul>
<li>ç¤ºä¾‹1</li>
</ul>
<pre><code class="language-C++">int* func()
{
	int* a = new int(10);
	return a;
}
int main() {
	int *p = func();
	cout &lt;&lt; *p &lt;&lt; endl;
	//åˆ©ç”¨deleteé‡Šæ”¾å †åŒºæ•°æ®
	delete p;
	//cout &lt;&lt; *p &lt;&lt; endl; //æŠ¥é”™ï¼Œé‡Šæ”¾çš„ç©ºé—´ä¸å¯è®¿é—®
	return 0;
}
</code></pre>
<ul>
<li>ç¤ºä¾‹2</li>
</ul>
<pre><code class="language-C++">//å †åŒºå¼€è¾Ÿæ•°ç»„
int main() {
	int* arr = new int[10];
	for (int i = 0; i &lt; 10; i++)
	{
		arr[i] = i + 100;
	}
	for (int i = 0; i &lt; 10; i++)
	{
		cout &lt;&lt; arr[i] &lt;&lt; endl;
	}
	//é‡Šæ”¾æ•°ç»„ delete ååŠ  []
	delete[] arr;
	return 0;
}
</code></pre>
<ul>
<li>ç¤ºä¾‹3</li>
</ul>
<pre><code class="language-C++">//åŠ¨æ€å†…å­˜åˆ†é…
//newå¼€è¾ŸäºŒç»´æ•°ç»„ç©ºé—´
#include&lt;iostream&gt;
#include&lt;algorithm&gt;
using namespace std;

void chan(int **a)
{
	int b[3][3];
	for (int i = 0; i &lt; 3; ++i)
		for (int j = 0; j &lt; 3; ++j)
			b[i][j] = a[j][i];
	for (int i = 0; i &lt; 3; ++i)
		for (int j = 0; j &lt; 3; ++j)
			a[i][j] = b[i][j];
}

int main()
{
	int **a;
	a = new int*[3];
	for (int i = 0; i &lt; 3; ++i)
		a[i] = new int[3];
	int k = 0;

	for (int i = 0; i &lt; 3; ++i)
		for (int j = 0; j &lt; 3; ++j)
			a[i][j] = k++;

	chan(a);
	for (int i = 0; i &lt; 3; ++i)
	{
		for (int j = 0; j &lt; 3; ++j)
			cout &lt;&lt; a[i][j] &lt;&lt; ' ';
		cout &lt;&lt; endl;
	}
	for (int i = 0; i &lt; 3; ++i)
		delete[] a[i];
	delete[] a;
	return 0;
}
</code></pre>
<h3 id="å¼•ç”¨">å¼•ç”¨</h3>
<h5 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h5>
<ul>
<li>å¼•ç”¨å¿…é¡»åˆå§‹åŒ–ã€‚</li>
</ul>
<blockquote>
<p>å¼•ç”¨å˜é‡æ˜¯ä¸€ä¸ªåˆ«åï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯æŸä¸ªå·²å­˜åœ¨å˜é‡çš„å¦ä¸€ä¸ªåå­—ã€‚ä¸€æ—¦æŠŠå¼•ç”¨åˆå§‹åŒ–ä¸ºæŸä¸ªå˜é‡ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å¼•ç”¨åç§°æˆ–å˜é‡åç§°æ¥æŒ‡å‘å˜é‡ã€‚</p>
</blockquote>
<ul>
<li>å¼•ç”¨åœ¨åˆå§‹åŒ–ä¹‹åä¸å¯ä»¥æ”¹å˜ã€‚</li>
</ul>
<h5 id="å¼•ç”¨å’ŒæŒ‡é’ˆçš„ä¸åŒä¹‹å¤„">å¼•ç”¨å’ŒæŒ‡é’ˆçš„ä¸åŒä¹‹å¤„</h5>
<ul>
<li>ä¸å­˜åœ¨ç©ºå¼•ç”¨ã€‚å¼•ç”¨å¿…é¡»è¿æ¥åˆ°ä¸€å—åˆæ³•çš„å†…å­˜ã€‚</li>
<li>ä¸€æ—¦å¼•ç”¨è¢«åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¸èƒ½è¢«æŒ‡å‘åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚æŒ‡é’ˆå¯ä»¥å†ä»»ä½•æ—¶å€™æŒ‡å‘åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚ä½†æ˜¯æŒ‡é’ˆå¯ä»¥åœ¨ <strong>ä»»ä½•æ—¶é—´</strong> æŒ‡å‘åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚</li>
<li>å¼•ç”¨å¿…é¡»åœ¨åˆ›å»ºæ—¶è¢«åˆå§‹åŒ–ã€‚æŒ‡é’ˆå¯ä»¥åœ¨ä»»ä½•æ—¶é—´è¢«åˆå§‹åŒ–</li>
</ul>
<h5 id="æŠŠå¼•ç”¨ä½œä¸ºå‚æ•°å€¼ä¸è¿”å›å€¼">æŠŠå¼•ç”¨ä½œä¸ºå‚æ•°å€¼ä¸è¿”å›å€¼</h5>
<pre><code>Cä¸­æœ‰åˆ©ç”¨&amp;è¾¾åˆ°ä¼ å…¥æ•°å­—è¿›è¡Œswapæ“ä½œï¼ŒC++ä¸­åŒæ ·æœ‰ç±»ä¼¼æ“ä½œ
</code></pre>
<pre><code class="language-C">#include&lt;stdio.h&gt;
void swap(int* a, int* b)
{
	int temp = *a;
	*a = *b;
	*b = temp;
}
int main()
{
	int a = 10;
	int b = 20;
	swap(&amp;a, &amp;b);
	printf(&quot;%d,%d&quot;, a, b);
	return 0;
}
</code></pre>
<ul>
<li>C++ä¸­æŠŠå¼•ç”¨ä½œä¸ºå‚æ•°</li>
</ul>
<pre><code class="language-C++">#include &lt;iostream&gt;
using namespace std;
void swap(int&amp; x, int&amp; y);
int main ()
{
   int a = 100;
   int b = 200;
   cout &lt;&lt; &quot;äº¤æ¢å‰ï¼Œa çš„å€¼ï¼š&quot; &lt;&lt; a &lt;&lt; endl;
   cout &lt;&lt; &quot;äº¤æ¢å‰ï¼Œb çš„å€¼ï¼š&quot; &lt;&lt; b &lt;&lt; endl;
   swap(a, b);//æœ€çªå‡ºçš„ä¸€ç‚¹æ˜¯a,bä¸å¸¦ä»»ä½•ç¬¦å·ï¼Œä½†å´èƒ½è¿›è¡Œæ¢ä½
   cout &lt;&lt; &quot;äº¤æ¢åï¼Œa çš„å€¼ï¼š&quot; &lt;&lt; a &lt;&lt; endl;
   cout &lt;&lt; &quot;äº¤æ¢åï¼Œb çš„å€¼ï¼š&quot; &lt;&lt; b &lt;&lt; endl;
 
   return 0;
}
void swap(int&amp; x, int&amp; y)
{
   int temp;
   temp = x; /* ä¿å­˜åœ°å€ x çš„å€¼ */
   x = y;    /* æŠŠ y èµ‹å€¼ç»™ x */
   y = temp; /* æŠŠ x èµ‹å€¼ç»™ y  */
  
   return;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åŸºäºkaliè™šæ‹Ÿæœºçš„ç½‘ç»œæ¸—é€æŠ€æœ¯(äºŒ)scapy DHCPåŸºç¡€]]></title>
        <id>https://unmaned-air.github.io/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-ji-zhu-yi-scapy-dhcp-ji-chu/</id>
        <link href="https://unmaned-air.github.io/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-ji-zhu-yi-scapy-dhcp-ji-chu/">
        </link>
        <updated>2022-04-26T02:19:34.000Z</updated>
        <content type="html"><![CDATA[<h3 id="dhcpåè®®æ¦‚è¦">DHCPåè®®æ¦‚è¦</h3>
<blockquote>
<p>åŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼ˆ<em>Dynamic Host Comfiguration Protocol</em>ï¼‰ï¼Œå·¥ä½œåœ¨åº”ç”¨å±‚ï¼Œæ˜¯ä¸€ä¸ªå±€åŸŸç½‘çš„åè®®ï¼Œä¸»è¦ç”¨æ¥ç»™å†…éƒ¨ç½‘ç»œè‡ªåŠ¨åˆ†é…IPåœ°å€ã€‚<br>
DHCPæœåŠ¡å™¨ä¿ç®¡ç€IPåœ°å€ï¼Œåˆ†é…æ–¹å¼æ˜¯æŒ‰ç…§ç¡¬ä»¶åœ°å€ï¼ˆMACï¼‰åˆ†é…IPåœ°å€ã€‚</p>
</blockquote>
<h3 id="dhcpçš„å·¥ä½œåŸç†ä¸æµç¨‹">DHCPçš„å·¥ä½œåŸç†ä¸æµç¨‹</h3>
<ul>
<li>å®¢æˆ·ç«¯åœ¨å±€åŸŸç½‘å†…å‘èµ·ä¸€ä¸ª <a href="#ah"><em>DHCP Discover</em> </a>æŠ¥æ–‡ï¼›</li>
<li>æ¥æ”¶åˆ°<em>DHCP Discover</em>åŒ…çš„æœåŠ¡ç«¯ä¼šå‘è¯·æ±‚çš„å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª <a href="#ahh"><em>DHCP Offer</em> </a>æŠ¥æ–‡;</li>
<li>å®¢æˆ·ç«¯ä¼šå¹¿æ’­ä¸€ä¸ª<a href="#ahhh"><em>DHCP Request</em></a>ï¼Œå£°æ˜è‡ªå·±é€‰ç”¨çš„æœåŠ¡ç«¯å’ŒIPåœ°å€ï¼›</li>
<li>æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯å¹¿æ’­çš„DHCP RequestæŠ¥æ–‡ä¹‹åï¼Œå°±ä¼šåˆ¤æ–­è¯¥æŠ¥æ–‡ä¸­çš„IPåœ°å€æ˜¯å¦ä¸è‡ªå·±çš„åœ°å€ç›¸åŒï¼Œå¦‚æœç›¸åŒï¼Œå°±ä¼šå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå“åº”çš„DHCP ACKæŠ¥æ–‡ã€‚</li>
</ul>
<blockquote>
<p>DHCPçš„å‰èº«æ˜¯BOOTPåè®®ï¼ŒDHCPæ¯”BOOTPæ›´å¤æ‚ï¼ŒåŠŸèƒ½ä¹Ÿæ›´åŠ å¼ºå¤§ï¼Œ<mark>ä½†æ˜¯åœ¨scapyå’ŒWireSharkç­‰æµè¡Œå·¥å…·ä¸­è¿˜æ˜¯å°†DHCPåè®®åˆ†æˆDHCPå’ŒBOOTPä¸¤ä¸ªéƒ¨åˆ†æ¥çœ‹å¾…ã€‚</mark></p>
</blockquote>
<h3 id="python-å¦‚ä½•å®ç°">Python å¦‚ä½•å®ç°</h3>
<p>åˆ©ç”¨ <em>ls()</em> å‡½æ•°å¯ä»¥æŸ¥æ‰¾ç›¸å…³å‚æ•°ï¼Œæˆ‘ä»¬åˆ©ç”¨ä»¥ä¸‹ç¨‹åºæŸ¥çœ‹scapyä¸­ä¸¤ä¸ªéƒ¨åˆ†çš„å†…å®¹ï¼š</p>
<pre><code class="language-Python">from scapy.all import *
ls(BOOTP)
ls(DHCP)
</code></pre>
<ul>
<li><a id="ah"><em>DHCP Discover</em></a>æ•°æ®åŒ…çš„æ„é€ ï¼š<br>
åˆ©ç”¨*RandMAC()*å‡½æ•°ç”Ÿæˆéšæœºåœ°å€</li>
</ul>
<pre><code class="language-python">mac_random = str(RandMAC()) //è½¬åŒ–æˆå­—ç¬¦ä¸²å½¢å¼
Ether_Discover = Ether(src = mac.random,dst=&quot;ff:ff:ff:ff:ff:ff&quot;)//16ä¸ªfæ˜¯å¹¿æ’­çš„æ„æ€
</code></pre>
<p><em>BOOTP</em> åè®®è¦è®¾ç½®çš„å‚æ•°æœ‰<em>xid</em>ã€<em>chaddr</em>ï¼ˆ<em>å’Œä»¥å¤ªä¸­å‡ºç°çš„srcåº”è¯¥ç›¸åŒ</em>ï¼‰<br>
<em>DHCP</em> åè®®è¦è®¾ç½®çš„å‚æ•°æ˜¯<em>options</em></p>
<pre><code class="language-python">from scapy.all import *
import binascii
xid_random = random.randint(1,100000000)
mac_random = str(RandMAC())
dhcp_discover = Ether(src=mac_random,dst=&quot;ff:ff:ff:ff:ff:ff&quot;)/IP(src=&quot;0.0.0.0&quot;,dst=&quot;255.255.255.255&quot;)/UDP(sport=68,dport=67)/BOOTP(chaddr=mac_random,xid=xid_random,flags=32768)/DHCP(options=[(&quot;message-type&quot;,&quot;discover&quot;),&quot;end&quot;])# sportï¼šå‘å‡ºï¼›dportï¼šç›®æ ‡.  å®¢æˆ·ç«¯ï¼š68ï¼›æœåŠ¡ç«¯ï¼š67.
sendp(dhcp_discover,iface='eth0')
print(&quot;yep______________________&quot;)
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://unmaned-air.github.io/post-images/1650969152294.png" alt="" loading="lazy"></figure>
<ul>
<li>æ•è·<a id="ahh"><em>DHCP offer</em></a>æ•°æ®åŒ…<br>
å…ˆè¿è¡Œå¦‚ä¸‹ç¨‹åº</li>
</ul>
<pre><code class="language-python">from scapy.all import *
def d_d(pkt):
    if DHCP in pkt:
        pkt.show()
sniff(filter=&quot;src port 67&quot;,prn=d_d,coun=1)
</code></pre>
<p>å†è¿è¡Œdiscoverï¼Œå¾—åˆ°ä¸‹åˆ—æ•°æ®<br>
<img src="https://unmaned-air.github.io/post-images/1650973730571.png" alt="" loading="lazy"></p>
<ul>
<li>æ„é€ <a id="ahhh"><em>DHCP Request</em></a>æ•°æ®åŒ…</li>
</ul>
<ol>
<li>Etheréƒ¨åˆ†éœ€è¦è®¾ç½®ä¸¤ä¸ªå‚æ•°srcå’Œdst</li>
<li>IPéƒ¨åˆ†ä¹Ÿæ˜¯è®¾ç½®ä¸¤ä¸ªå‚æ•°srcå’Œdst</li>
<li>ä¼ è¾“å±‚åè®®ä½UDP</li>
<li>BOOTPä¸­éœ€è¦æŒ‡æ˜xidå’Œæœ¬æœºçš„MACåœ°å€</li>
<li>DHCPä¸­éœ€è¦æŒ‡æ˜DHCPæœåŠ¡ç«¯çš„IPåœ°å€å’Œç”³è¯·çš„IPåœ°å€</li>
</ol>
<blockquote>
<p>Request = Ether_Request*()/IP_Request()/UDP_Request()/BOOTP()/DHCP_Request()</p>
</blockquote>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="language-python">from scapy.all import*
def detect_dhcp(pkt):
    if DHCP in pkt:
        if pkt[DHCP].options[0][1]==2:
            E_R = Ether(src = pkt[BOOTP].chaddr,dst = pkt[Ether].src)
            I_R = IP(src=&quot;0.0.0.0&quot;,dst=&quot;255.255.255.255&quot;)
            U_R = UDP(sport = 68,dport = 67)
            B_R = BOOTP(chaddr=pkt[BOOTP].chaddr,xid = pkt[BOORP].xid)
            D_R = DHCP(options=[(&quot;message-type&quot;,'request),(&quot;server_id&quot;,pkt[DHCP].options[1][1]),(&quot;requested_addr&quot;,pkt[BOOTP].yiaddr),&quot;end&quot;])
             R=E_R/I_R/U_R/B_R/D_R
             sendp(R,iface='eth0')
             print(pkt[BOOTP].yiaddr+&quot;distributing&quot;)
     if pkt[DHCP].options[0][1]==5:
         print(pkt[BOOTP].yiaddr+&quot;distributed&quot;)
 sniff(filter=&quot;src port 67&quot;,prn=d_d,count=3)
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æœºå™¨å­¦ä¹ ç›®å½•]]></title>
        <id>https://unmaned-air.github.io/post/ji-qi-xue-xi-mu-lu/</id>
        <link href="https://unmaned-air.github.io/post/ji-qi-xue-xi-mu-lu/">
        </link>
        <updated>2022-04-25T11:47:01.000Z</updated>
        <summary type="html"><![CDATA[<p>å¬æˆ‘è¯´ï¼Œè°¢è°¢ä½ ï¼šï¼‰</p>
]]></summary>
        <content type="html"><![CDATA[<p>å¬æˆ‘è¯´ï¼Œè°¢è°¢ä½ ï¼šï¼‰</p>
<!-- more -->
<p>ï¼ˆä¸€ï¼‰<a href="http://localhost:4000/post/ji-qi-xue-xi-de-ji-ben-gai-nian/">æœºå™¨å­¦ä¹ ç›¸å…³æ¦‚å¿µ</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åŸºäºkaliè™šæ‹Ÿæœºçš„ç½‘ç»œæ¸—é€ç¬”è®°]]></title>
        <id>https://unmaned-air.github.io/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-bi-ji/</id>
        <link href="https://unmaned-air.github.io/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-bi-ji/">
        </link>
        <updated>2022-04-25T08:40:12.000Z</updated>
        <content type="html"><![CDATA[<p>ï¼ˆä¸€ï¼‰<a href= "http://localhost:4000/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-ji-zhu/">scapyåŸºç¡€</a><br>
ï¼ˆäºŒï¼‰<a href="http://localhost:4000/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-ji-zhu-yi-scapy-dhcp-ji-chu/">DHCPåè®®</a><br>
ï¼ˆä¸‰ï¼‰DNSåè®®</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å®‰å…¨æ„Ÿçš„æ¥æºæ˜¯è‡ªå·±çš„èƒ½åŠ›]]></title>
        <id>https://unmaned-air.github.io/post/an-quan-gan-de-lai-yuan-shi-zi-ji-de-neng-li/</id>
        <link href="https://unmaned-air.github.io/post/an-quan-gan-de-lai-yuan-shi-zi-ji-de-neng-li/">
        </link>
        <updated>2022-04-25T07:53:08.000Z</updated>
        <summary type="html"><![CDATA[<p>ç°åœ¨å¼€å§‹è¿˜æ¥å¾—åŠ</p>
]]></summary>
        <content type="html"><![CDATA[<p>ç°åœ¨å¼€å§‹è¿˜æ¥å¾—åŠ</p>
<!-- more -->
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åŸºäºkaliè™šæ‹Ÿæœºçš„ç½‘ç»œæ¸—é€æŠ€æœ¯(ä¸€)scapyæ•°æ®åŒ…åŸºç¡€]]></title>
        <id>https://unmaned-air.github.io/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-ji-zhu/</id>
        <link href="https://unmaned-air.github.io/post/ji-yu-kali-xu-ni-ji-de-wang-luo-shen-tou-ji-zhu/">
        </link>
        <updated>2022-04-24T05:14:37.000Z</updated>
        <summary type="html"><![CDATA[<blockquote>
<p>è™½ç„¶æˆ‘å¤§å‘¼ï¼šâ€œç–«æƒ…æ»šå‡ºä¸­å›½ï¼ï¼â€<br>
ä½†äº‹ç‰©éƒ½å…·æœ‰ä¸¤é¢æ€§ã€‚æ„Ÿè°¢2022å¹´4æœˆçš„ç–«æƒ…è®©æˆ‘çš„æ€¨ç§å¯¼å¸ˆç›‘ç£æˆ‘å­¦ä¹ ç½‘ç»œæ¸—é€</p>
</blockquote>
]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>è™½ç„¶æˆ‘å¤§å‘¼ï¼šâ€œç–«æƒ…æ»šå‡ºä¸­å›½ï¼ï¼â€<br>
ä½†äº‹ç‰©éƒ½å…·æœ‰ä¸¤é¢æ€§ã€‚æ„Ÿè°¢2022å¹´4æœˆçš„ç–«æƒ…è®©æˆ‘çš„æ€¨ç§å¯¼å¸ˆç›‘ç£æˆ‘å­¦ä¹ ç½‘ç»œæ¸—é€</p>
</blockquote>
<!-- more -->
<h3 id="__åˆ©ç”¨-scapy-åº“-__">__åˆ©ç”¨ <em>scapy</em> åº“ __</h3>
<p>ğŸ˜€ åˆ©ç”¨ <em>pkt=Ether()/IP()/ICMP()</em> æ„å»ºä¸€ä¸ªæ•°æ®åŒ…ï¼Œå¾€å¾€ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®åŒ…åšå‡ºä»¥ä¸‹æ“ä½œï¼š</p>
<h4 id="æ˜¾ç¤ºæ•°æ®åŒ…ä¸­çš„å†…å®¹">ğŸ˜¯æ˜¾ç¤ºæ•°æ®åŒ…ä¸­çš„å†…å®¹:</h4>
<p><em>pkt.raw()</em> è¡¨ç¤ºç”¨å­—èŠ‚æ ¼å¼æ˜¾ç¤ºå†…å®¹<br>
<em>hexdump()</em> åå…­è¿›åˆ¶æ˜¾ç¤º<br>
<em>pkt.summary()</em> ç”¨ä¸è¶…è¿‡ä¸€è¡Œçš„æ‘˜è¦æè¿°æ•°æ®åŒ…<br>
<em>pkt.show()</em> ç”¨è¡¨å•æ˜¾ç¤ºæ•°æ®<br>
å®ç°ç¤ºä¾‹ï¼š</p>
<pre><code class="language-Python">from scapy.all import *
pkt=Ether()/IP()/ICMP()
 print(&quot;pkt.raw()\n&quot;)
print(raw(pkt))
print(&quot;hexdump()\n&quot;)
print(hexdump(pkt))
print(&quot;pkt.summary()\n&quot;)
print(pkt.summary())
print(&quot;pkt.show()\n&quot;)
pkt.show()
</code></pre>
<p><img src="https://unmaned-air.github.io/post-images/1650875445799.png" alt="" loading="lazy">&quot;</p>
<h4 id="æŠ“æ•°æ®åŒ…"><strong>ğŸ˜ æŠ“æ•°æ®åŒ…</strong></h4>
<p><em>wepcap(&quot;file.cap&quot;,pkt)</em> åè€…æŒ‡è¦ä¿å­˜çš„æ•°æ®åŒ…ï¼Œå‰è€…æŒ‡ä¿å­˜å»çš„æ–‡ä»¶å<br>
<em>rec = rddpcap(&quot;file.cap&quot;)</em> è¯»å–æ•°æ®åŒ…<br>
å®ç°ç¤ºä¾‹ï¼š</p>
<pre><code class="language-python">  from scapy.all import *
  pkt=IP()/ICMP()
  print(&quot;get\n&quot;)
  wrpcap(&quot;get.cap&quot;,pkt)
  print(&quot;read\n&quot;)
  rec=rdpcap(&quot;get.cap&quot;)
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://unmaned-air.github.io/post-images/1650896283998.png" alt="" loading="lazy"></figure>
<h4 id="å‘é€æ•°æ®åŒ…"><strong>ğŸ¤“å‘é€æ•°æ®åŒ…</strong></h4>
<p><em>send()</em> å¯¹IPåœ°å€å‘é€æ•°æ®åŒ…<br>
<em>sendp()</em> å¯¹ç¡¬ä»¶åœ°å€å‘é€æ•°æ®åŒ…ï¼ˆMACï¼‰<br>
å®ç°ç¤ºä¾‹ï¼š</p>
<h4 id="å‘é€å’Œæ¥å—"><strong>ğŸ˜‹å‘é€å’Œæ¥å—</strong></h4>
<p>*sr()*ç”¨äºIPåœ°å€<br>
<em>srp()<em>ç”¨äºMACåœ°å€</em>ï¼ˆç‰©ç†åœ°å€ï¼‰</em><br>
å®ç°ç¤ºä¾‹ï¼š</p>
<h4 id="æŠ“åŒ…å‡½æ•°"><strong>ğŸ˜æŠ“åŒ…å‡½æ•°ï¼š</strong></h4>
<p><em>sniff(filter= ... ,iface=&quot;  ...&quot;,prn= ... ,count= ... )</em> å‚æ•°è¯´æ˜ï¼š<br>
filterï¼šè¿‡æ»¤å™¨ï¼Œè¦ç›‘å¬çš„åœ°å€ï¼ˆ è¦æŠ“<mark>ä»€ä¹ˆæ ·çš„æ•°æ®åŒ…</mark> ï¼‰<br>
ifaceï¼šç”¨æ¥æŒ‡å®šè¦ç”¨çš„ç½‘å¡ï¼ˆä»å“ªä½œä¸º<mark>å»æŠ“</mark>æ•°æ®åŒ…çš„åœ°æ–¹ï¼‰<br>
prnï¼šæŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œæ˜¯è¦å¯¹æ•°æ®åŒ…åšçš„å¤„ç†ï¼ˆåšä»€ä¹ˆï¼‰<br>
coutï¼šæŒ‡å®šè¦ç›‘å¬åˆ°çš„æ•°æ®åŒ…çš„æ•°é‡</p>
]]></content>
    </entry>
</feed>